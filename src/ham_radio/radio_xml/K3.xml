<!--
    Rig definition file for use with fldigi

Fldigi uses CAT commands for TX and RX control.
Set the K3 PTT-KEY menu to OFF-OFF on the rig, and don't assert either 
RTS or CTS in fldigi config.

Modified by ik5pvx to use bandwidth in Hz instead of the filter selections

-->

<RIGDEF>

  <RIG>Elecraft K3</RIG>

  <PROGRAMMER>
    Programmers: Dave, W1HKJ; 
                 Leigh L. Klotz, Jr. WA5ZNU and
                 Alan Steele VA3STL
    Tested by:   John, W1ZI
	Changes by:  Pierfrancesco Caci, IK5PVX
  </PROGRAMMER>

  <STATUS>
    Stable
    Version:    3.20.28
    Date:       5 September 2010
	ik5pvx-version: 20160116
  </STATUS>

  <TITLE>RigCAT - K3</TITLE>

  <!--
      default settings for initial setup
  -->

  <TIMEOUT>50</TIMEOUT>
  <RETRIES>2</RETRIES>
  <WRITE_DELAY>5</WRITE_DELAY>
  <BAUDRATE>38400</BAUDRATE>
  <RTSCTS>false</RTSCTS>
  <ECHO>false</ECHO>
  <STOPBITS>1</STOPBITS>
<!--
  <RTSCTS>false</RTSCTS>
  <DTRPLUS>true</DTRPLUS>
  <RTSPLUS>false</RTSPLUS>
  <DTRPTT>false</DTRPTT>
  <RTSPTT>false</RTSPTT>
-->
  <CMDPTT>true</CMDPTT>

  <MODES>
    <ELEMENT><SYMBOL>LSB</SYMBOL><BYTE>31</BYTE></ELEMENT>
    <ELEMENT><SYMBOL>USB</SYMBOL><BYTE>32</BYTE></ELEMENT>
    <ELEMENT><SYMBOL>CW</SYMBOL><BYTE>33</BYTE></ELEMENT>
    <ELEMENT><SYMBOL>FM</SYMBOL><BYTE>34</BYTE></ELEMENT>
    <ELEMENT><SYMBOL>AM</SYMBOL><BYTE>35</BYTE></ELEMENT>
    <ELEMENT><SYMBOL>DATA</SYMBOL><BYTE>36</BYTE></ELEMENT>
    <ELEMENT><SYMBOL>CW-R</SYMBOL><BYTE>37</BYTE></ELEMENT>
    <ELEMENT><SYMBOL>DATA-R</SYMBOL><BYTE>39</BYTE></ELEMENT>
  </MODES>

  <!-- lsb mode strings should match those given in the modes symbol specifier -->

  <LSBMODES>
    <STRING>LSB</STRING>
    <STRING>RTTY</STRING>
    <STRING>CW</STRING>
  </LSBMODES>

  <!-- Bandwidth steps in Hz. K3 can't set bw wider than 4 KHz. 
  -->
  
  <BANDWIDTHS>
	<ELEMENT><SYMBOL>50</SYMBOL><STRING>0005</STRING></ELEMENT>
	<ELEMENT><SYMBOL>100</SYMBOL><STRING>0010</STRING></ELEMENT>
	<ELEMENT><SYMBOL>150</SYMBOL><STRING>0015</STRING></ELEMENT>
	<ELEMENT><SYMBOL>200</SYMBOL><STRING>0020</STRING></ELEMENT>
	<ELEMENT><SYMBOL>250</SYMBOL><STRING>0025</STRING></ELEMENT>
	<ELEMENT><SYMBOL>300</SYMBOL><STRING>0030</STRING></ELEMENT>
	<ELEMENT><SYMBOL>350</SYMBOL><STRING>0035</STRING></ELEMENT>
	<ELEMENT><SYMBOL>400</SYMBOL><STRING>0040</STRING></ELEMENT>
	<ELEMENT><SYMBOL>450</SYMBOL><STRING>0045</STRING></ELEMENT>
	<ELEMENT><SYMBOL>500</SYMBOL><STRING>0050</STRING></ELEMENT>
	<ELEMENT><SYMBOL>550</SYMBOL><STRING>0055</STRING></ELEMENT>
	<ELEMENT><SYMBOL>600</SYMBOL><STRING>0060</STRING></ELEMENT>
	<ELEMENT><SYMBOL>650</SYMBOL><STRING>0065</STRING></ELEMENT>
	<ELEMENT><SYMBOL>700</SYMBOL><STRING>0070</STRING></ELEMENT>
	<ELEMENT><SYMBOL>750</SYMBOL><STRING>0075</STRING></ELEMENT>
	<ELEMENT><SYMBOL>800</SYMBOL><STRING>0090</STRING></ELEMENT>
	<ELEMENT><SYMBOL>850</SYMBOL><STRING>0095</STRING></ELEMENT>
	<ELEMENT><SYMBOL>1000</SYMBOL><STRING>0100</STRING></ELEMENT>
	<ELEMENT><SYMBOL>1100</SYMBOL><STRING>0110</STRING></ELEMENT>
	<ELEMENT><SYMBOL>1200</SYMBOL><STRING>0120</STRING></ELEMENT>
	<ELEMENT><SYMBOL>1300</SYMBOL><STRING>0130</STRING></ELEMENT>
	<ELEMENT><SYMBOL>1400</SYMBOL><STRING>0140</STRING></ELEMENT>
	<ELEMENT><SYMBOL>1500</SYMBOL><STRING>0150</STRING></ELEMENT>
	<ELEMENT><SYMBOL>1600</SYMBOL><STRING>0160</STRING></ELEMENT>
	<ELEMENT><SYMBOL>1700</SYMBOL><STRING>0170</STRING></ELEMENT>
	<ELEMENT><SYMBOL>1800</SYMBOL><STRING>0180</STRING></ELEMENT>
	<ELEMENT><SYMBOL>1900</SYMBOL><STRING>0190</STRING></ELEMENT>
	<ELEMENT><SYMBOL>2000</SYMBOL><STRING>0200</STRING></ELEMENT>
	<ELEMENT><SYMBOL>2100</SYMBOL><STRING>0210</STRING></ELEMENT>
	<ELEMENT><SYMBOL>2200</SYMBOL><STRING>0220</STRING></ELEMENT>
	<ELEMENT><SYMBOL>2300</SYMBOL><STRING>0230</STRING></ELEMENT>
	<ELEMENT><SYMBOL>2400</SYMBOL><STRING>0240</STRING></ELEMENT>
	<ELEMENT><SYMBOL>2500</SYMBOL><STRING>0250</STRING></ELEMENT>
	<ELEMENT><SYMBOL>2600</SYMBOL><STRING>0260</STRING></ELEMENT>
	<ELEMENT><SYMBOL>2700</SYMBOL><STRING>0270</STRING></ELEMENT>
	<ELEMENT><SYMBOL>2800</SYMBOL><STRING>0280</STRING></ELEMENT>
	<ELEMENT><SYMBOL>2900</SYMBOL><STRING>0290</STRING></ELEMENT>
	<ELEMENT><SYMBOL>3000</SYMBOL><STRING>0300</STRING></ELEMENT>
	<ELEMENT><SYMBOL>3100</SYMBOL><STRING>0310</STRING></ELEMENT>
	<ELEMENT><SYMBOL>3200</SYMBOL><STRING>0320</STRING></ELEMENT>
	<ELEMENT><SYMBOL>3300</SYMBOL><STRING>0330</STRING></ELEMENT>
	<ELEMENT><SYMBOL>3400</SYMBOL><STRING>0340</STRING></ELEMENT>
	<ELEMENT><SYMBOL>3500</SYMBOL><STRING>0350</STRING></ELEMENT>
	<ELEMENT><SYMBOL>3600</SYMBOL><STRING>0360</STRING></ELEMENT>
	<ELEMENT><SYMBOL>3700</SYMBOL><STRING>0370</STRING></ELEMENT>
	<ELEMENT><SYMBOL>3800</SYMBOL><STRING>0380</STRING></ELEMENT>
	<ELEMENT><SYMBOL>3900</SYMBOL><STRING>0390</STRING></ELEMENT>
	<ELEMENT><SYMBOL>4000</SYMBOL><STRING>0400</STRING></ELEMENT>
  </BANDWIDTHS>
  
  <REPLY>
    <SYMBOL>MODE</SYMBOL>
    <SIZE>4</SIZE>
    <STRING>MD</STRING>
    <DATA>
      <DTYPE>BYTE</DTYPE>
      <SIZE>1</SIZE>
    </DATA>
    <STRING>;</STRING>
  </REPLY>

  <REPLY>
    <SYMBOL>FREQ</SYMBOL>
    <SIZE>14</SIZE>
    <STRING>FA</STRING>
    <DATA>
      <DTYPE>DECIMAL</DTYPE>
      <SIZE>11</SIZE>
      <MAX>99999999999</MAX>
      <MIN>00001500000</MIN>
      <RESOL>1</RESOL>
    </DATA>
    <STRING>;</STRING>
  </REPLY>  

  <!-- 
       Response to a request for Bandwidth
       On K3 in mode K31 simply use the BW command. 

  -->

  <REPLY>
    <SYMBOL>BW</SYMBOL> 
    <SIZE>7</SIZE>
    <STRING>BW</STRING>
    <DATA>
      <DTYPE>DECIMAL</DTYPE>
      <SIZE>4</SIZE>
	  <MAX>9999</MAX>
	  <MIN>0000</MIN>
	  <RESOL>1</RESOL>
    </DATA>
    <STRING>;</STRING>
  </REPLY>

  <!-- 
       Initialization command
	   K31 is the appropriate extended command set for K3
  -->

  <COMMAND>
    <SYMBOL>INIT</SYMBOL>
    <SIZE>3</SIZE>
    <STRING>K31;</STRING>
  </COMMAND>

  <!-- min freq is 490 kHz with old KSYN3, or 100 kHz with KSYN3A -->

  <COMMAND>
    <SYMBOL>SETFREQ</SYMBOL>
    <SIZE>14</SIZE>
    <STRING>FA</STRING>
    <DATA>
      <DTYPE>DECIMAL</DTYPE>
      <SIZE>11</SIZE>
      <MAX>99999999999</MAX>
      <MIN>00000490000</MIN>
      <RESOL>1</RESOL>
    </DATA>
    <STRING>;</STRING>
  </COMMAND>

  <COMMAND>
    <SYMBOL>GETFREQ</SYMBOL>
    <SIZE>3</SIZE>
    <STRING>FA;</STRING>
    <INFO>FREQ</INFO>
  </COMMAND>

  <COMMAND>
    <SYMBOL>SETMODE</SYMBOL>
    <SIZE>4</SIZE>
    <STRING>MD</STRING>
    <DATA>
      <DTYPE>BYTE</DTYPE>
      <SIZE>1</SIZE>
    </DATA>
    <STRING>;</STRING>
    <OK>MODE</OK>
  </COMMAND>

  <COMMAND>
    <SYMBOL>GETMODE</SYMBOL>
    <SIZE>3</SIZE>
    <STRING>MD;</STRING>
    <INFO>MODE</INFO>
  </COMMAND>

  <COMMAND>
    <SYMBOL>SETBW</SYMBOL>
    <SIZE>7</SIZE>
    <STRING>BW</STRING>
    <DATA>
      <DTYPE>DECIMAL</DTYPE>
      <SIZE>4</SIZE>
	  <MAX>9999</MAX>
	  <MIN>0000</MIN>
	  <RESOL>1</RESOL>
    </DATA>
    <STRING>;</STRING>
    <OK>OK</OK>
    <BAD>BAD</BAD>
  </COMMAND>

  <COMMAND>
    <SYMBOL>GETBW</SYMBOL>
    <SIZE>3</SIZE>
    <STRING>BW;</STRING>
    <INFO>BW</INFO>
  </COMMAND>

  <COMMAND>
    <SYMBOL>PTTON</SYMBOL>
    <SIZE>3</SIZE>
    <STRING>TX;</STRING>
  </COMMAND>

  <COMMAND>
    <SYMBOL>PTTOFF</SYMBOL>
    <SIZE>3</SIZE>
    <STRING>RX;</STRING>
  </COMMAND>

</RIGDEF>
